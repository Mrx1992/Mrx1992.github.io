# 模块参数(4)

## fake super(假超级)
- 为一个模块设置 "fake super = yes "会导致守护进程方面的行为就像指定了-fake-super命令行选项一样。
- 这就允许存储文件的全部属性，而不需要守护进程实际以root身份运行。

<!-- TODO:这里 -->
## filter(过滤)

## exclude(排除文件)

例子：
```
exclude=add.txt

上传时这个模块遇到add.txt文件时将会忽略
```

- 这个参数是一个以空格分隔的守护进程排除模式列表，
- 与客户端的--exclude选项一样，模式可以用"-"或 "+"限定，明确表示排除/包含。

- 和客户端的--exclude选项一样，模式可以用"-"或 "+"来限定，以明确表示排除/包含。
- 一个给定的模块只能使用一个 "exclude "参数。参见 "filter "参数，以了解被排除的文件如何影响守护进程。

## include（包含文件）
- 使用 "include "来覆盖 "exclude "参数的效果。
- 一个给定的模块只能使用一个 "include "参数。参见 "filter "参数，以了解被排除的文件如何影响守护进程。

## exclude from（排除合并）
- 该参数指定守护进程上包含守护进程排除模式的文件名，每行一个。
- 一个给定的模块只能应用一个 "exclude from "参数；
- 如果你有多个exclud-from文件，你可以在 "filter "参数中把它们指定为一个合并文件。
- 请参阅 "filter "参数，了解排除的文件如何影响守护进程。

## include from（包含合并）
- 类似于 "exclude from "的守护进程包含模式文件。
- 只有一个 "include from "参数可以适用于一个给定的模块。
- 请参阅 "filter "参数，了解排除的文件如何影响守护进程。

## incoming chmod（传入权限）

- 这个参数允许你指定一组以逗号分隔的chmod字符串，这些字符串将影响所有传入文件（守护进程正在接收的文件）的权限。
- 这些改变发生在所有其他权限计算之后，当客户端没有指定--perms时，这些改变甚至会覆盖目的地默认和/或现有的权限。
- 关于这个字符串的格式， 请参阅 --chmod rsync 选项的描述和 chmod(1) manpage。

```
[rsync]
path=/home/mrx/rsync
incoming chmod = Du=rwx,Dog=rx,Fu=rwx,Fgo=rx

就会强制把同步以后的
目录用户权限：rwx
目录用户组和其他用户：rx
文件用户权限：rwx
文件用户组和其他用户：rx
```

## outgoing chmod（导出权限）

- 这个参数允许你指定一组以逗号分隔的chmod字符串，这些字符串将影响所有外发文件（从守护进程发送出去的文件）的权限。
- 这些变化首先发生，使得发送的权限看起来与文件系统本身存储的权限不同。
- 例如，你可以在服务器上禁用组写权限，同时让它看起来是在客户端。
- 关于这个字符串的格式， 请参阅 --chmod rsync 选项的描述和 chmod(1) manpage。

```
[rsync]
path=/home/mrx/rsync
incoming chmod = Du=rwx,Dog=rwx,Fu=rwx,Fgo=rwx

拉取远程目录文件时：
就会强制把（本地文件/目录）的权限
目录用户权限：rwx
目录用户组和其他用户：rwx
文件用户权限：rwx
文件用户组和其他用户：rwx
```

## auth users（认证用户）

- 这个参数指定了一个以逗号和/或空格分隔的授权规则列表。
- 最简单的形式是列出允许连接到这个模块的用户名，这些用户名不需要存在于本地系统中。
- 这些规则可能包含shell通配符，这些通配符将与客户端提供的用户名进行匹配以进行身份验证。
- 如果设置了 "auth users"，那么客户端将受到挑战，提供用户名和密码来连接到模块。
- 这种交换采用挑战响应认证协议。纯文本的用户名和密码被存储在 "secrets file "参数指定的文件中。
- 默认情况下，所有用户都可以在没有密码的情况下进行连接（这被称为 "匿名rsync"）。

- 除了用户名匹配外，你还可以通过'@'前缀指定组名匹配。
- 当使用组名匹配时，验证用户名必须是系统中的真实用户，否则将被假定为不属于任何组的成员。
- 例如，指定"@rsync"，如果指定的用户是rsync组的成员，则会匹配认证用户。

- 最后，可以在冒号(:)后面指定选项。
- 这些选项允许您 "拒绝 "一个用户或一个组，将访问设置为 "ro"（只读），或将访问设置为 "rw"（读/写）。
- 设置特定于自动规则的 ro/rw 设置会覆盖模块的 "只读 "设置。

- 请确保按照您希望它们被匹配的顺序来设置规则，
（支持正则）
- 因为检查会在第一个匹配的用户或组上停止，而这是唯一被检查的auth。


- 例如:
`auth users = joe:deny @guest:deny admin:rw @rsync:ro susan joe sam`
- 在上述规则中，用户joe无论如何都会被拒绝访问。
- 任何在 "guest "组中的用户也会被拒绝访问。
- 户 "admin "可以在读/写模式下获得访问权限，但前提是admin用户不在 "guest "组中
- （因为如果用户在 "guest "组中，管理员用户匹配规则将永远无法达成）
- 其他任何在 "rsync "组中的用户都将获得只读访问权。
- 最后，用户susan、joe和sam可以获得模块的ro/rw设置，但前提是该用户不符合之前的组匹配规则。

- 如果你需要指定一个带有空格的用户或组名，
- 用逗号开始你的列表，以表示该列表只能在逗号上分割（尽管前导和尾部的空白也会被删除，而空条目会被忽略）。
- 例如：
`auth users = , joe:deny, @Some Group:deny, admin:rw, @RO Group:ro`
- 请参阅secrets file的描述，了解如何拥有每个用户密码以及每个组密码。
- 它还解释了用户如何使用他们的用户密码或（在适用的情况下）组密码进行验证，这取决于正在验证的规则。

- 另请参见 rsync(1) 中 "USING RSYNC-DAEMON FEATURES VIA A REMOTE SHELL CONNECTION" 一节， 
- 以了解当使用远程 shell 连接到 rsync 守护进程时， 
- 如何处理不同于远程 shell 级用户名的 rsyncd.conf 级用户名。